<html>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, height=device-height, initial-scale=1'>
<title>Simone</title>
<style type='text/css'>
@font-face {
font-family: 'Leds';
src: url(data:font/woff2;base64,d09GMgABAAAAAAUUAA8AAAAADaAAAAS6AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGQ4/RkZUTRwaHgZgAIJCCAQRCAqLXIkICxwAATYCJAMiBCAFh1IHPBsnC0AuB2xjmNRHsRStRjsVHYuydDRul3d+ztjgeX4c/rlPA5mcBKQ5JTeorjmtqTptaUkKbfv/5/17PYF8gtb3RuT7guaCkzd4hTZPHpuMlXkeutqbvzf6eqfQKZxwN3iYxVkIU0/hhYBfusn5749z/2st7xye2BDPEqnwiOnvzPns/7gk8SRuoVlziWadRCV0opd4lRJZYGf25urCG0aAJwADQAAPe8Qu4PbSk1kAuL1tK4UwAOArVCRQQBGaL6HToPqJ4pl59WGw2F32/0N5D9UlHBQ70cXWntl+6udAmBzNDf7PSpMIjwEQgHzTcwBIFAZ0bMZCgw3FIgiIFSkRYBgCCirIqepfGACkBwEAEkCJ4xaVurXO4xsR/gEMzZNiBJDKfvB7ZaIB+UAeUAsAAAOyhANwFMsyLEfz4FoTHBNlnZfzWvJ5FiKJcl7FztPa4HVjRQAIigUHz4t9rJ/pTY7x7vNbOc86zDl+OHl1NfuIlKGeubnVo9f2l+SvMnPxvePtS3sXFlcPe73EtolF/oYuskDqvRxI6GmOXz3J5hP0G8McgGEf2FRjsEUo9kDkQk3yApEE/ZZlwObAfduIc/9V0UBMlvJgHpFxSzvh1i3aYY0R/clLT3hd3vDR0iMaGoraPT7VF269d5cH695X8CIljjtcm7C9Wp1SGXndLnoaEx5M0Av9s7zIwYH/ql2DWekled0TCY+iM9uIwPg7pRXGhDt45QZ0R0Bqq4/vu5gt3Omq+V3u5T2DiWffiCa3pUlPnf5pP53pONxg/trzNR3julsSn76Ld7prfv2M26Hhhg8M/lPDmm+IfzhJj9WuRW/fn+4Ltz67S0PlT2tNYYq51a2pKRcoUvumWaRNF3FNs6dK+hALNSM1CdurNSlVmW6mt697e3Q3tfdOj/Cc2eSLfK4DwFGY7PmqR8tPzRXXPaxE6ggARIAV4IxefmuQXw1hQPDfHLkzllL8VYJ+v+apVlpPekSWrXhmGibXFiIsAAC+CDiiDH4D49KcV9PoynLEyPQelJfWTg8DfgrFAHiDPIByFADgbx8KTJOHyCk8k6mp0CqnlpJDfgMJvXBaXnm72AlsMiCCtF4gOyB0isBkayq02qnVptlvwtDbTis4L17CScxHszRUhNg0JIyQGpcOlwwJs/mk+XEaaC8FCW0UEynICWvug9iY3M/OrRIMTWMVxCGkpmKGu5WHweaDa7qQwcpB6E/n0BBADBkOhq7CzaZQNrMlcS8N6fxgaJSMEJ+ABqpRpVpdyGNYqDvagTxZy5u5up02a9gYNEmBVYYGyO1pR4vz5kinGlXNuWwGl5qP1IVWGYYUWtr7bFEjCv6vabLE+OIUSR6GCuy9b0Y3rcbuw+/QSZWrnn3BD3+gm3NM3uaBv8SiHu5l78NeLqdOxtGba/hv5Tyfy0P3/rJmh8c+uAWfzSKwKAtQV01HhZ/ogv8Gy/332BdupGCHAigmUrOTxFxTKXhJuAIfUputwvfeamtQVdA77u21GxENyP4LgLJiuoWKz8UaWoWaGStFjaSBmNp1Hbl392SrCRWqQAgePBsYSTuzyM2qjWUrVfj/91af8ns7/G1CZMqSLUeuPPkKFAIAAA==)
format('woff2');
}
html, body {
font-family: sans-serif;
margin: 0;
padding: 0;
background-color: lightgray;
overflow:hidden;
}
.small {
font-size: 10px;
}
.touch {
cursor: pointer;
}
svg {
border: 1px solid black;
width: 100%;
height: 100%;
}
#help {
display: none;
position: fixed;
left: 50%;
background-color: white;
border: 2px solid black;
transform: translateX(-50%);
width: 80%;
padding: 1em 1em 1em 1em;
margin-top: 1em;
}
#help > p {
text-indent: -20px;
margin-left: 20px;
margin-bottom: 0;
margin-top: 0;
}
svg text {
pointer-events: none;
text-anchor: middle;
dominant-baseline: middle;
stroke: none;
}
#replay {
display: none;
}
#visiboard text {
fill: black;
}
#blindboard text {
fill: gray;
}
#visiboard #countNum {
fill: red;
font-size: 16pt;
font-family: Leds;
}
</style>
<script type='text/javascript'>
const h={H:"green",I:"red",J:"yellow",C:"blue"};function k(){for(var a=[h.I,h.J,h.C,h.H],b=[],c=0;3>c;c++)a.forEach(d=>{b.push(d)});return n(b,!0)}function p(a,b){switch(a){case h.C:return b?209:195.998;case h.J:return b?252:261.626;case h.I:return b?310:329.628;case h.H:return b?415:391.995;default:return 0}}function n(a,b){var c=[];a.forEach((d,e)=>{d={color:d,S:p(d,b),delay:50};0!=e||b||(d.delay=0);c.push(d)});return c}
function q(a){switch(a){case 0:return 8;case 1:return 14;case 2:return 20;default:return 31}}function r(a){var b=Object.values(h);a=Array(q(a.O)).fill(0).map(()=>b[parseInt(Math.random()*b.length,10)]);return n(a,!1)}function u(a){a.D||(a.j=!1,v(a,!0),a.h||w(a,!0),x(a,[{delay:100,M:1500,S:42,color:null}]))}function y(a,b){a.u||(b&&(a.L=Date.now()),a.s||a.h||(!a.B&&3E3<Date.now()-a.L?u(a):setTimeout(()=>{y(a)},10)))}function v(a,b){a.D=!!b;z(a.g,a.D?"red":"darkgray")}
function w(a,b){A(a.g,"start",b);A(a.g,"levels",b);A(a.g,"replay",b)}function x(a,b,c){a.u=!0;var d=c||0;a.B=!1;b.forEach(e=>{B(a.R,d+e.delay,e.M,e.S,a.g,e.color,a.l);d+=e.delay+e.M});setTimeout(()=>{a.u=!1;y(a,!0);a.s&&(w(a,!0),a.j=!1)},d)}function C(a,b,c){var d=c?100:6>b?420:14>b?320:220;return a.map(e=>{e.M=d;return e})}function D(a,b,c){setTimeout(()=>{E(a.g,a.i)},b||0);var d=C(a.v.slice(0,a.i),a.i,!1);x(a,d,b+c)}
function F(a,b){a.s=!0;setTimeout(()=>{z(a.g,"rgb(0,200,0)")},b);var c=C(a.T,a.i,!0);x(a,c,b)}function G(a){var b=simone;b.K||(b.K=!0,b.padDown(a))}
class H{constructor(a,b){this.g=a;this.R=b;this.N=1;this.O=this.A=this.L=0;this.P=null;this.v=[];this.m=this.i=0;this.T=k();this.u=this.G=this.B=this.l=this.K=this.F=this.s=this.j=this.h=this.D=this.o=!1;this.mute(0);this.blind(0);this.level(0);this.rotate();E(this.g,0)}blind(a){if(this.o="undefined"===typeof a?!this.o:1==a)this.l=!1,I(this.g,"muteCir",J(this.l));I(this.g,"blindCir",J(this.o))}freeplay(){if(this.D||!this.j)this.h=!this.h,v(this,!1),A(this.g,"start",!this.h),A(this.g,"levels",!this.h),
A(this.g,"replay",!1),E(this.g,0),I(this.g,"freeplayCir",J(this.h))}help(a){this.F="undefined"===typeof a?!this.F:1==a;I(this.g,"helpCir",J(this.F));A(this.g,"help",this.F)}keyDown(a){switch(a.key){case "?":simone.help();return;case "b":simone.blind();return;case "f":simone.freeplay();return;case "m":simone.mute();return;case "r":simone.replay();return;case "s":simone.start();return;case "x":simone.rotate();return;case "1":simone.level(0);return;case "2":simone.level(1);return;case "3":simone.level(2);
return;case "4":simone.level(3);return}switch(a.keyCode){case 37:G(h.J);break;case 38:G(h.H);break;case 39:G(h.I);break;case 40:G(h.C)}}keyUp(a){switch(a.keyCode){case 37:case 38:case 39:case 40:a=simone,a.K=!1,a.padUp()}}latch(a){this.A?a!=this.A&&K(this.g,!1):this.A=a}level(a){if(!this.u){this.s=this.j=!1;this.m=0;this.v=[];v(this,!1);this.O=a;for(var b=this.g,c=0;5>c;c++)I(b,"lev"+c,J(c==a))}}mute(a){if(this.l="undefined"===typeof a?!this.l:1==a)this.o=!1,I(this.g,"blindCir",J(this.o));I(this.g,
"muteCir",J(this.l))}padDown(a){this.B=!0;this.A=0;if(!this.u&&!this.s&&this.j||this.h){var b=p(a,!1),c=a==this.P?100:0,d=0<this.v.length&&this.m<this.v.length?a==this.v[this.m].color:!1;if(d||this.h)L(this.R,this.N,c,b,this.g,a,this,this.l,this.G),this.P=a,this.N++;this.h||(d?(this.m++,this.m>=this.i&&(this.i++,this.i<=this.v.length?(this.m=0,D(this,c+420,500)):(this.i--,F(this,c+920)))):u(this))}}padUp(){this.B=!1;this.L=Date.now()}replay(){this.A=0;this.u||this.h||(this.j=!0,this.s=!1,this.m=0,
v(this,!1),w(this,!1),D(this))}rotate(a){if(!this.j){this.G="undefined"===typeof a?!this.G:a;a=this.g;var b=this.G,c=M(a,"pads");c&&(N(a),b?c.setAttribute("transform","rotate(45 105 105)"):c.removeAttribute("transform"),O(a,b))}}start(){this.A=0;this.u||this.h||(this.v=r(this),this.s=!1,this.j=!0,v(this,!1),w(this,!1),this.m=0,this.i=1,z(this.g,"darkgray"),K(this.g,this.o),D(this))}}function E(a,b){M(a,"countNum").textContent=""+b}function z(a,b){M(a,"countBox").setAttribute("stroke",b)}
function K(a,b){M(a,"blindboard").style.display=b?"inline":"none";M(a,"visiboard").style.display=b?"none":"inline"}
function P(a){var b=M(a,"blindboard"),c=window.innerWidth,d=window.innerHeight;b.setAttribute("viewBox","0 0 "+c+" "+d);var e=Q(a,"rect");e.setAttribute("width",c);e.setAttribute("height",d);e.setAttribute("fill","black");b.appendChild(e);var f=d/4,l=c/2;a.g.forEach((m,g)=>{switch(g){case 0:var t=g=4;break;case 1:g=l+4;t=4;break;case 2:g=4;t=f+4;break;default:g=l+4,t=f+4}m=R(a,m,l-4-4,f-4-4,g,t,null,null);b.appendChild(m)});c=3*f;b.appendChild(R(a,null,l-4-4,f-4-4,4,c+4,"simone.start()","S"));b.appendChild(R(a,
null,l-4-4,f-4-4,l+4,c+4,"simone.replay()","R"));c=f/4;d=S(a,l/2,2.5*f,c,"simone.latch(1)");b.appendChild(d);c=S(a,1.5*l,2.5*f,c,"simone.latch(2)");b.appendChild(c);c=Q(a,"text");c.setAttribute("x",l);c.setAttribute("y",2.1*f);c.appendChild(a.h.createTextNode("Touch both circles to exit."));b.appendChild(c)}
function T(a){a.g.forEach(b=>{M(a,b).setAttribute("onmousedown",'simone.padDown("'+b+'")');M(a,b).setAttribute("onmouseup","simone.padUp()");M(a,b).setAttribute("onmouseleave","simone.padUp()")});a.g.forEach(b=>{var c="blind"+b;M(a,c).setAttribute("onmousedown",'simone.padDown("'+b+'")');M(a,c).setAttribute("onmouseup","simone.padUp()");M(a,c).setAttribute("onmouseleave","simone.padUp()")})}
function O(a,b){a.g.forEach(c=>{var d=M(a,c),e=Q(a,"path");e.setAttribute("id",c+"shadow");e.setAttribute("d",d.getAttribute("d"));e.setAttribute("transform","translate("+(b?"2 2":"0 3")+")");e.setAttribute("fill","black");e.setAttribute("stroke","black");e.setAttribute("stroke-width","1");d.parentNode.insertBefore(e,d)})}function M(a,b){return a.h.getElementById(b)}function N(a){a.g.forEach(b=>{(b=M(a,b+"shadow"))&&b.parentElement.removeChild(b)})}
function Q(a,b){return a.h.createElementNS("http://www.w3.org/2000/svg",b)}function S(a,b,c,d,e){a=Q(a,"circle");a.setAttribute("cx",b);a.setAttribute("cy",c);a.setAttribute("r",d);a.setAttribute("class","touch");a.setAttribute("stroke","gray");a.setAttribute("fill","black");a.setAttribute("onclick",e);return a}
function R(a,b,c,d,e,f,l,m){var g=Q(a,"rect");b&&g.setAttribute("id","blind"+b);g.setAttribute("class","touch");g.setAttribute("width",c);g.setAttribute("height",d);g.setAttribute("stroke","gray");g.setAttribute("fill","black");g.setAttribute("x",e);g.setAttribute("y",f);g.setAttribute("rx",4);g.setAttribute("ry",4);l&&g.setAttribute("onclick",l);return m?(b=Q(a,"text"),b.setAttribute("x",e+c/2),b.setAttribute("y",f+d/2),b.appendChild(a.h.createTextNode(m)),a=Q(a,"g"),a.appendChild(g),a.appendChild(b),
a):g}function I(a,b,c){(a=M(a,b))&&a.setAttribute("fill",c)}function J(a){return a?"lightblue":"white"}function U(a,b){switch(a){case h.C:return b?"url(#blueGrad)":"darkblue";case h.H:return b?"url(#greenGrad)":"darkgreen";case h.I:return b?"url(#redGrad)":"darkred";case h.J:return b?"url(#yellowGrad)":"rgba(234,186,0)";default:return"pink"}}function A(a,b,c){M(a,b).style.display=c?"inline":"none"}function V(a,b){M(a,b).removeAttribute("transform");M(a,b+"shadow").removeAttribute("display")}
function W(a,b,c){I(a,b,U(b,c))}class X{constructor(){this.h=document;this.g=Object.values(h);P(this);T(this);O(this)}}function B(a,b,c,d,e,f,l){var m=a.i.createOscillator();m.type="square";m.frequency.value=l?0:d;m.connect(a.i.destination);setTimeout(()=>{m.start();W(e,f,1)},b);setTimeout(()=>{m.stop();W(e,f,0)},b+c)}
function L(a,b,c,d,e,f,l,m,g){a.j=b;a.g&&a.g.stop();a.h&&(W(a.h,a.color,0),V(a.h,a.color));a.h=e;a.color=f;a.g=a.i.createOscillator();a.g.type="square";a.g.frequency.value=m?0:d;a.g.connect(a.i.destination);setTimeout(()=>{a.g.start();W(e,f,1);var t=g?"2 2":"0 3";M(e,f).setAttribute("transform","translate("+t+")");M(e,f+"shadow").setAttribute("display","none")},c);setTimeout(()=>{Y(a,b,e,f,l,m)},c+420)}
function Y(a,b,c,d,e,f){a.j==b&&(e.B?setTimeout(()=>{Y(a,b,c,d,e,f)},10):(W(c,d,0),V(c,d),a.g.stop(),a.g=null))}class Z{constructor(){this.i=new AudioContext;this.color=this.h=this.g=this.j=null}}window.init=function(){var a=new X,b=new Z;a=new H(a,b);window.simone=a};
</script>
</head>
<body onload='init()' onkeydown='simone.keyDown(event)' onkeyup='simone.keyUp(event)'>
<div id='help' onclick='simone.help(0)'>
<p><b>?</b>: Show this help text. Touch the help to dismiss it.</p>
<p><b>1,2,3,4</b>: Level.
<b>1</b> = Repeat eight notes to win.
<b>2</b> = Repeat fourteen notes to win.
<b>3</b> = Repeat twenty notes to win.
<b>4</b> = Repeat thirty-one notes to win.
</p>
<p><b>B</b>: Blind mode (for playing on a phone). After pressing
'S', the screen will be replaced with large rectangular buttons on a black
background and the game will begin. Notes will be played with no visual effects.
</p>
<p><b>F</b>: Freeplay. Press buttons at will.</p>
<p><b>M</b>: Mute the sound.</p>
<p><b>R</b>: Replay the previous sequence.</p>
<p><b>S</b>: Start the game.</p>
<div style='font-size: x-small'>
This program is free software; you can distribute it and/or modify it under
the terms of the <a href='https://www.gnu.org/licenses/'>GNU General Public License</a> version 2.
<a href='https://www.waitingforfriday.com/?p=586'>Reverse Engineering a Simon Game</a> was used as a reference.
The Simon game, created by Milton Bradley, was the inspiration for this program.
<a href='https://fontlibrary.org/en/font/segment7'>Segment7</a> is the LED font.
</div>
</div>
<svg id='blindboard' viewBox='-10 -10 230 230' xmlns='http://www.w3.org/2000/svg' display='none'>
</svg>
<svg id='visiboard' viewBox='-10 -10 230 230' xmlns='http://www.w3.org/2000/svg'>
<g fill='white' stroke='black' stroke-width='1'>
<circle cx='105' cy='106' r='113' fill='dimgray' stroke-width='1' />
<g id='levels'>
<circle id='lev0' class='touch' cx='75' cy='80' r='6' onclick='simone.level(0)' />
<text class='small' x='75' y='81'>1</text>
<circle id='lev1' class='touch' cx='95' cy='80' r='6' onclick='simone.level(1)' />
<text class='small' x='95' y='81' >2</text>
<circle id='lev2' class='touch' cx='115' cy='80' r='6' onclick='simone.level(2)' />
<text class='small' x='115' y='81'>3</text>
<circle id='lev3' class='touch' cx='135' cy='80' r='6' onclick='simone.level(3)' />
<text class='small' x='135' y='81'>4</text>
</g>
<g id='start'>
<circle class='touch' cx='78' cy='131' r='10' fill='lightgreen' onclick='simone.start()' />
<text x='78' y='132' class='small'>S</text>
</g>
<g id='counter'>
<rect id='countBox' x='90' y='93' width='30' height='30' rx='2' ry='2' stroke-width='2' fill='black' />
<text id='countNum' class='small' x='105' y='112' stroke='red'></text>
</g>
<g id='replay'>
<circle class='touch' cx='132' cy='131' r='10' fill='yellow' onclick='simone.replay()' />
<text x='132' y='132' class='small'>R</text>
</g>
<g id='pads'>
<path id='green' class='touch' d='M100,50 v-50 a100,100 0 0,0 -100,100 h 50 a50,50 0 0,1 50,-50 z' fill='darkgreen' />
<path id='red' class='touch' d='M110,50 v-50 a100,100 0 0,1 100,100 h -50 a50,50 0 0,0 -50,-50 z' fill='darkred' />
<path id='yellow' class='touch' d='M50,110 h -50 a100,100 0 0,0 100,100 v-50 a50,50 0 0,1 -50,-50 z' fill='rgb(224,186,0)' />
<path id='blue' class='touch' d='M160,110 h 50 a100,100 0 0,1 -100,100 v-50 a50,50 0 0,0 50,-50 z' fill='darkblue' />
</g>
<g id='mute'>
<circle id='muteCir' class='touch' cx='10' cy='10' r='10' onclick='simone.mute()' />
<text class='small' x='10' y='11'>M</text>
</g>
<g id='blind'>
<circle id='blindCir' class='touch' cx='200' cy='10' r='10' onclick='simone.blind()' />
<text class='small' x='200' y='11' fill='black'>B</text>
</g>
<g>
<circle id='helpCir' class='touch' cx='10' cy='200' r='10' onclick='simone.help()' />
<text x='10' y='201' class='small'>?</text>
</g>
<g>
<circle id='freeplayCir' class='touch' cx='200' cy='200' r='10' onclick='simone.freeplay()' />
<text class='small' x='200' y='201' fill='black'>F</text>
</g>
</g>
<radialGradient id='redGrad' cx='50%' cy='50%' r='50%' fx='50%' fy='50%'>
<stop offset='0%' stop-color='rgb(250, 160, 160)' />
<stop offset='100%' stop-color='darkred' />
</radialGradient>
<radialGradient id='blueGrad' cx='50%' cy='50%' r='50%' fx='50%' fy='50%'>
<stop offset='0%' stop-color='lightblue' />
<stop offset='100%' stop-color='darkblue' />
</radialGradient>
<radialGradient id='yellowGrad' cx='50%' cy='50%' r='50%' fx='50%' fy='50%'>
<stop offset='0%' stop-color='rgb(255,255,170)' />
<stop offset='100%' stop-color='rgb(224,186,0)' />
</radialGradient>
<radialGradient id='greenGrad' cx='50%' cy='50%' r='50%' fx='50%' fy='50%'>
<stop offset='0%' stop-color='lightgreen' />
<stop offset='100%' stop-color='darkgreen' />
</radialGradient>
</svg>
</body>
</html>
